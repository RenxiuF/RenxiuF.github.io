---
title: Docker的使用
filename: 20250918  
tags:  
  - blog   
  - rag  
categories:  
  - 技术分享
date: 2025-09-18 
description:   
articleGPT: 这篇文章介绍了Docker的一些基础用法
top: true  
share: true  
delete: false  
---

## 安装
[windows安装DockerDesktop](https://blog.csdn.net/qq_60750453/article/details/128636298?ops_request_misc=%257B%2522request%255Fid%2522%253A%25225c3d2eeb2ddb54bd7f7cf72490e92719%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=5c3d2eeb2ddb54bd7f7cf72490e92719&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-128636298-null-null.nonecase&utm_term=docker&spm=1018.2226.3001.4450)

## 测试
[Windows环境下使用Docker进行Python应用镜像打包与部署指南](https://www.oryoy.com/news/windows-huan-jing-xia-shi-yong-docker-jin-xing-python-ying-yong-jing-xiang-da-bao-yu-bu-shu-zhi-nan.html)


## 用法总结

### 容器和镜像

镜像是静态的，包含程序运行所需的所有内容（代码，库，依赖等），可以被多次复用，创建多个容器，类似“安装包”

容器是镜像的可运行实例，有自己的文件系统、进程、网络和配置，类似虚拟机

### 构建镜像

```bash
 # my-image:latest
 docker build -t <image_name> . 
 # my-image:v1
 docker build -t <image_name>:v1 .
```

`-t`选项用于给镜像命名，`.`表示当前目录。

### 查看镜像

```
docker images
```

### 启动容器

```bash
docker run -it --name <container_name> <image_name> bash   # 启动新容器 --rm 临时容器
exit # 退出容器
docker run -d --name <container_name> <image_name>   # 后台启动容器
docker ps          # 查看正在运行的容器
docker ps -a       # 查看所有容器（包括停止的）
docker start <container_name>      # 后台启动，但不输出日志
docker start -ai <container_name>  # 前台启动并附加终端
docker stop <container_name> # 停止容器运行
docker kill <container_name> # 强制停止容器运行
docker rm <container_name>   # 删除容器
```

### [挂载数据](https://blog.csdn.net/weixin_54574094/article/details/139000457)

```dockerfile
# dockerfile
# 声明数据卷
VOLUME /app/工资条
VOLUME /app/工资条备份
```

#### -v

```
docker run -it --name mycontainer \
  -v ./工资条:/app/工资条 \
  -v ./工资条备份:/app/工资条备份 \
  <image> bash

```

`./工资条:/app/工资条`	将本地的`./工资条`挂载到容器的`/app/工资条`



### 复制文件到容器

```bash
docker cp <宿主机路径> <容器ID或名称>:<容器内路径>
```

### 进入容器查看文件内容

```
docker exec -it <container_name> cat /hello.txt
```

### 删除镜像
查看有哪些镜像
```bash
docker images
```

使用镜像ID或镜像名称:tag删除

```bash
dcker rmi <image_name>:<tag>
```

`docker rmi -f `强制删除

### 保存和加载镜像/容器

```bash
docker save -o target.tar <image_name>
docker load -i <image>.tar
```



| 功能                                   | `docker export` + `docker import`                | `docker save` + `docker load`        |
| -------------------------------------- | ------------------------------------------------ | ------------------------------------ |
| **作用对象**                           | **容器 (container)**                             | **镜像 (image)**                     |
| **保存内容**                           | 只包含容器文件系统，不包含镜像历史和层信息       | 包含完整镜像（所有层、历史、标签等） |
| **生成文件**                           | `.tar`（容器快照）                               | `.tar`（完整镜像包）                 |
| **导入方式**                           | `docker import file.tar new_image:tag`           | `docker load -i file.tar`            |
| **是否保留构建历史 (Dockerfile 层)**   | ❌ 不保留                                         | ✅ 保留                               |
| **是否包含环境变量、启动命令等元数据** | ❌ 不包含                                         | ✅ 包含                               |
| **适用场景**                           | 迁移一个运行后修改过的容器的文件系统，快速做快照 | 迁移/备份镜像，完整复用环境          |

**提交容器为镜像**

```bash
docker commit <container_id> <image_name>:latest
```

### dockerfile

如果下载`python:3.9-slim`时间较长，可以先`docker pull <image_name>`，再构建。


* **dockerfile**
```dockerfile
# 使用官方Python基础镜像
FROM python:3.9-slim

# 设置工作目录
WORKDIR /app

# 先复制依赖文件并安装
COPY requirements.txt /app/
RUN pip install --no-cache-dir -r requirements.txt

# 再复制源码
COPY . /app

# 声明数据卷
VOLUME /app/工资条
VOLUME /app/工资条备份

# 运行应用
CMD ["python", "send_email.py"]

```

* **.dockerignore**
```dockerfile
# 排除日志文件
*.log

# 排除临时文件夹
工资条/
工资条备份/

# 排除本地配置文件
.env
```





